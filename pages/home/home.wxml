<!--pages/home/home.wxml-->
<wxs module="Math">
    module.exports = {
        colcal: function (x, y) {
            if (parseInt(x / 2) % 2 == 1) {
                if (parseInt(x / 4) % 2 == 1)
                    return 2;
                else
                    return 1;
            }
            else {
                if (y == 2)
                    return 3;
                else
                    return 0;
            }
        },
        cal: function (x, y) {
            if (parseInt(x / 8) % 2 == 1)
                return 2;
            else if (y == 2)
                return 3;
            else if (parseInt(x / 2) % 2 == 1)
                return 1;
            else
                return 0;
        },
        appear: function (x, y) {
            if (y == 0)
                return (parseInt(x / 8) % 2 == 0) && (parseInt(x / 2) % 2 == 1) ? true : false
            else if (y == 1)
                return (parseInt(x / 8) % 2 == 0) && (parseInt(x / 2) % 2 == 0) ? true : false
            else if (y == 2)
                return true
        },
        //判断显示七日内被删除的记录
        appears: function (x,y) {
            return (parseInt(x / 8) % 2 == 1)&&(y==2) ? true : false
        }
    }
</wxs>
<van-tabs sticky active="{{ activeTab }}" custom-class="tabbar" swipeable="{{true}}" animated="{{true}}"
    bind:change="switchTab">
    <van-tab title="已审批">
        <showMy kind="{{kind}}" refresh="{{refresh}}" />
    </van-tab>
    <van-tab title="审批中">
        <showMy kind="{{kind}}" refresh="{{refresh}}" />
    </van-tab>
    <van-tab title="历史记录">
        <showMy kind="{{kind}}" refresh="{{refresh}}" />
    </van-tab>
</van-tabs>
<!-- 显示七天内取消的记录 -->
<view class="total" wx:for="{{my_rsvs}}" wx:if="{{Math.appears(item.state,activeTab)}}">
    <view class="detail">
        <view class="which">预约设备：{{item.item_id}}</view>
        <view class="pic{{Math.colcal(item.state,activeTab)}}" hover-class="haspic{{Math.colcal(item.state,activeTab)}}"
            style=" text-align: center;width: 30%;border-radius: 20rpx">{{colst[Math.colcal(item.state,activeTab)]}} >
        </view>
    </view>
    <view class="divline"></view>
    <view class="detail">
        <view style="width:50%">预约编号：</view>
        <view style="width:50%;text-align:right">{{item.id}}</view>
    </view>
    <view class="detail">
        <view style="width:50%">预约状态：</view>
        <view style="margin-left:200rpx;text-align:right">{{st[Math.cal(item.state,activeTab)]}}</view>
    </view>
</view>
<!-- 显示其他记录 -->
<view class="total" wx:for="{{activeTab==2?his_rsvs:my_rsvs}}" wx:if="{{Math.appear(item.state,activeTab)}}">
    <view class="detail">
        <view class="which">预约设备：{{item.item_id}}</view>
        <view class="pic{{Math.colcal(item.state,activeTab)}}" hover-class="haspic{{Math.colcal(item.state,activeTab)}}"
            style=" text-align: center;width: 30%;border-radius: 20rpx">{{colst[Math.colcal(item.state,activeTab)]}} >
        </view>
    </view>
    <view class="divline"></view>
    <view class="detail">
        <view style="width:50%">预约编号：</view>
        <view style="width:50%;text-align:right">{{item.id}}</view>
    </view>
    <view class="detail">
        <view style="width:50%">预约状态：</view>
        <view style="margin-left:200rpx;text-align:right">{{st[Math.cal(item.state,activeTab)]}}</view>
    </view>
</view>